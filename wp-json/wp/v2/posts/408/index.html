{"id":408,"date":"2023-07-14T11:14:55","date_gmt":"2023-07-14T09:14:55","guid":{"rendered":"https:\/\/bigdatatime.eu\/?p=408"},"modified":"2023-07-17T17:05:13","modified_gmt":"2023-07-17T15:05:13","slug":"training-of-a-spam-classification-model","status":"publish","type":"post","link":"https:\/\/bigdatatime.eu\/training-of-a-spam-classification-model\/","title":{"rendered":"Training of a Spam Classification Model"},"content":{"rendered":"<p>The rise of short message communication in recent years has provided individuals and businesses with a fast and interactive way to communicate with their peers and customers. However, this has also led to an increase in the number of spam messages, particularly on publicly available channels. In response to this, we will build a classification model that can identify if a message is spam and allows for an adjustable risk level, ensuring that low-risk messages are immediately displayed while others are moved to a folder for further analysis. We will base our model on this <a href=\"http:\/\/archive.ics.uci.edu\/dataset\/228\/sms+spam+collection\">dataset<\/a>.<\/p>\n<p>To achieve these objectives, this project will follow the CRISP-DM framework, a widely used methodology that provides a structured approach to planning a data science project. We will cover all the necessary steps, including business understanding, data understanding, data preparation, modeling, evaluation, and a suggestion for deployment.<\/p>\n<h2>Organizing the Project with CRISP-DM<\/h2>\n<p>The first step in the CRISP-DM methodology is the Business Understanding step, which involves understanding the business objectives and requirements of the given task. In this step, we need to define the goals and objectives of the project and identify the stakeholders. This will help us to define the scope of the project and ensure that we deliver a solution that meets the needs of the stakeholders. We will base this project on a fictitious company that has tasked us with building a spam filter for their open channel to enable effective communication with their customers while maintaining message quality.<\/p>\n<h3>Business Understanding<\/h3>\n<p>For this project, the business objective is to build a spam filter for a new open communication channel that the company wants to install for its products. The aim is to enable fast and interactive feedback for their customers or possible future customers. The spam filter should be able to identify spam messages from short messages and allow for adjustments with respect to the risk of allowing spam to pass. This means that the spam filter should be adjustable via different spam-risk levels, e.g., low-risk (very restrictive) and high-risk (not restrictive). The messages passing the low-risk level are immediately displayed, while the other ones are moved to a folder for further analysis.<\/p>\n<p>The stakeholders in this project are the company, the service team who will be responsible for using the spam filter to filter out spam messages, and the customers, who will be using the open channel to provide feedback or ask questions on the company\u2019s products. It is important to keep in mind the expectations of these stakeholders while developing the spam filter so that we can deliver a solution that is effective and meets the needs of all groups. For the company the emphasis lies on not losing customers from misclassified messages, the service team wants a system that simplifies their daily work and the customers do not want to read too many spam messages, although a lost customer will probably hurt the company more than a spam message entering the channel.<\/p>\n<p>In addition to the primary objectives of the project, it is also important to consider any constraints and assumptions that may impact the project. For example, we could have limitations in terms of the resources available to us, such as the amount of data that we have access to or the computing power required to train and test our models. We may also have to make assumptions about the types of messages that are likely to be classified as spam and adjust our approach accordingly. By considering these constraints and assumptions, we can ensure that we deliver a solution that is realistic and feasible given the resources available to us.<\/p>\n<h3>Constraints and Assumptions<\/h3>\n<p>Based on the dataset and the resources available, we can identify the following constraints:<\/p>\n<ul>\n<li>The dataset only includes English messages, so the model will only be able to classify English messages accurately.<\/li>\n<li>The dataset has a limited number of messages, which may not be representative of all types of messages that the company may receive.<\/li>\n<li>The analysis and model training will be done on a home desktop PC, which may have limitations in terms of computational power and memory.<\/li>\n<\/ul>\n<p>and assumptions:<\/p>\n<ul>\n<li>The messages in the dataset are correctly labeled as ham or spam.<\/li>\n<li>The dataset is a representative sample of the types of messages that the company may receive.<\/li>\n<li>The spam filter will be used in a similar context as the dataset, so the model will generalize well to new messages.<\/li>\n<\/ul>\n<h3>Data Understanding<\/h3>\n<p>To start the data understanding step, we will first load the dataset and check for any missing values and duplicates. We will use the Pandas library to load the CSV file containing the messages and perform basic exploratory data analysis (EDA).<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-410\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_missing-values.jpg\" alt=\"\" width=\"222\" height=\"157\" \/><\/p>\n<p>From the above output, we can see that there are no missing values in the dataset, but there are 403 duplicate records. We will remove these duplicate records from the dataset and look at the number of resulting unique records.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-411\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_unique-values.jpg\" alt=\"\" width=\"179\" height=\"49\" \/><\/p>\n<p>Next, we will explore the distribution of the target variable label with the help of Matplotlib and Seaborn. Additionally, we look at the distribution of the character count of the messages.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-412\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_variable-distribution.jpg\" alt=\"\" width=\"445\" height=\"340\" srcset=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_variable-distribution.jpg 445w, https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_variable-distribution-300x229.jpg 300w\" sizes=\"(max-width: 445px) 100vw, 445px\" \/><\/p>\n<p>From the first visualization, we can see that the dataset is imbalanced as there are more ham messages than spam messages. This must be accounted for before we train our classifier.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-413\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_message-length-distribution.jpg\" alt=\"\" width=\"684\" height=\"547\" srcset=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_message-length-distribution.jpg 684w, https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_message-length-distribution-300x240.jpg 300w\" sizes=\"(max-width: 684px) 100vw, 684px\" \/><\/p>\n<p>Plotting the distribution of the message lengths, we can observe that spam messages tend to have longer message lengths compared to ham messages. Further looking into the number of digits and special characters reveals that spam messages tend to have more digits.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-414\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_digits-special-char-distribution.jpg\" alt=\"\" width=\"775\" height=\"737\" srcset=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_digits-special-char-distribution.jpg 775w, https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_digits-special-char-distribution-300x285.jpg 300w, https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_digits-special-char-distribution-768x730.jpg 768w\" sizes=\"(max-width: 775px) 100vw, 775px\" \/><\/p>\n<p>Another interesting feature that we will explore is the number of unique words per message type<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-415\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_unique-words-distribution.jpg\" alt=\"\" width=\"742\" height=\"340\" srcset=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_unique-words-distribution.jpg 742w, https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_unique-words-distribution-300x137.jpg 300w\" sizes=\"(max-width: 742px) 100vw, 742px\" \/><\/p>\n<p>and lastly, we plot word clouds to spot possible differences in vocabulary.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-416\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_wordclouds.jpg\" alt=\"\" width=\"753\" height=\"239\" srcset=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_wordclouds.jpg 753w, https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_wordclouds-300x95.jpg 300w\" sizes=\"(max-width: 753px) 100vw, 753px\" \/><\/p>\n<p>With this, we conclude the EDA and move further on to the data preparation step where we will balance the dataset and choose the most interesting features for training the model. The engineered features for each message will be message lengths, the number of unique words, and a TF-IDF representation of the vocabulary. We will omit the special character distribution as ham and spam messages are very similar in this regard.<\/p>\n<h3>Data Preparation<\/h3>\n<p>For the next step, we perform data preprocessing and feature engineering on the SMS message dataset. We load the data from the source CSV file, remove duplicates, and create new columns such as message length, number of digits, number of unique words, and a lemmatized version of the messages. The text data is then transformed into a matrix of TF-IDF values using the TfidfVectorizer class of the scikit-learn library. The resulting features are saved along with the trained vectorizer. Additionally, the dataset is balanced by sampling an equal number of ham and spam messages. The target variable is encoded as 0 for ham and 1 for spam and finally, the prepared dataset is saved as a new CSV file.<\/p>\n<h3>Model Training<\/h3>\n<p>For training, we first load our prepared dataset of messages and split it into training and testing sets. Then we perform a grid search with cross-validation to find the best hyperparameters for our classifier which will be a decision tree. Additionally, the feature importances are retrieved from the trained classifier, and a barplot is created to visualize the top 10 most important features.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-417\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_predictor-importance.jpg\" alt=\"\" width=\"759\" height=\"360\" srcset=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_predictor-importance.jpg 759w, https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_predictor-importance-300x142.jpg 300w\" sizes=\"(max-width: 759px) 100vw, 759px\" \/><\/p>\n<p>Examining the plot, we can see that the model clearly favors the number of digits in a message as a decision factor. Following we have specific words and our other engineered features.<\/p>\n<h3>Error Analysis<\/h3>\n<p>After training our model, we will now further analyze the performance. To do this we compute a confusion matrix on our training and test datasets.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-419\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_confusion-matrix.jpg\" alt=\"\" width=\"764\" height=\"436\" srcset=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_confusion-matrix.jpg 764w, https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_confusion-matrix-300x171.jpg 300w\" sizes=\"(max-width: 764px) 100vw, 764px\" \/><\/p>\n<p>Additionally, we also retrieve accuracy, precision, and recall for each dataset respectively.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-418\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_error-analysis.jpg\" alt=\"\" width=\"186\" height=\"182\" \/><\/p>\n<p>From the metrics, we can conclude that the model performs sufficiently well on our initial dataset. Additionally, we will look into the distribution of misclassified messages.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-420\" src=\"https:\/\/bigdatatime.eu\/wp-content\/uploads\/2023\/07\/spam-classification_unique-values-1.jpg\" alt=\"\" width=\"179\" height=\"49\" \/><\/p>\n<p>With this, we can assume that the model is not particularly biased toward one of the message types. Finally, we will test the model on 10 new messages that were generated with a language model and consist of 5 ham and 5 spam messages. The test results can be examined in the analysis Jupyter Notebook and revealed a reasonable out-of-sample performance and generalization. Although the emphasis of the model on digit counts makes spam messages with no digits and ham messages with more digits hard to classify correctly.<\/p>\n<h2>Deployment<\/h2>\n<p>To integrate the spam classification model into the service team\u2019s workflow, we could develop a web application using Django. The steps involved in creating and deploying this system would be as follows:<\/p>\n<ol>\n<li>Set up the Django project structure and configure the necessary settings.<\/li>\n<li>Design the database schema to store messages and their classifications.<\/li>\n<li>Set up an API endpoint that receives incoming messages, assuming we have the possibility to control message flow from our communication channels&#8217; backend.<\/li>\n<li>Implement the web interface using Django\u2019s template system and HTML\/CSS.<\/li>\n<li>Integrate the spam classification model into the project and develop the function to classify messages.<\/li>\n<li>Implement an adjustable spam level control, allowing the service team to set the level of stringency for classifying messages as spam. The level would be a percentage threshold that can be used for comparison with the probabilities of class membership that the model returns in percentages.<\/li>\n<li>Deploy the Django application on a cloud platform.<\/li>\n<li>Conduct thorough testing and quality assurance to ensure functionality and performance.<\/li>\n<li>Provide documentation and training to guide the service team on using the web application effectively.<\/li>\n<li>Maintain and improve the system based on feedback and ongoing monitoring.<\/li>\n<\/ol>\n<h2>Conclusion<\/h2>\n<p>The objective of this project was to build a classification model capable of identifying spam in short messages. The CRISP-DM methodology was followed, covering business understanding, data understanding, data preparation, modeling, evaluation, and a suggestion for deployment. The dataset\u2019s quality was assessed, and findings were visualized for better comprehension. A decision tree classifier was created, trained, and tested using the provided dataset and additional out-of-sample data. An error analysis was conducted to identify weaknesses in the approach, which would be the reliance on digits for classifying spam. Finally, a proposal was made to integrate the model into the daily work of the service team. The solution would be in the form of a graphical user interface (GUI) based on a Django web application.<\/p>\n<p>In summary, this project successfully developed a classification model for spam identification in short messages. The model returns class membership certainties in percentages which can be further utilized to build logic for adjustable risk levels. Further improvements to the model could be made by gathering additional data or data that is more representative of the use case, i.e. short messages of product feedback or questions. Additionally, there is the possibility of engineering alternative features to reduce reliance on the digit count. The project demonstrates the efficacy of data science methodologies in addressing real-world challenges, offering a valuable solution for the company. The code for this project can be viewed in this <a href=\"https:\/\/github.com\/marco507\/Spam-Classification-Model\">GitHub repo<\/a>.<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>The rise of short message communication in recent years has provided individuals and businesses with a fast and interactive way to communicate with their peers [&#8230;]<\/p>\n","protected":false},"author":2,"featured_media":422,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[10,8,1],"tags":[],"_links":{"self":[{"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/posts\/408"}],"collection":[{"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/comments?post=408"}],"version-history":[{"count":4,"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/posts\/408\/revisions"}],"predecessor-version":[{"id":424,"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/posts\/408\/revisions\/424"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/media\/422"}],"wp:attachment":[{"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/media?parent=408"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/categories?post=408"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/bigdatatime.eu\/wp-json\/wp\/v2\/tags?post=408"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}